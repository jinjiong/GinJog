<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <title>境外旅行险</title>
    <link rel="shortcut icon" href="images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="css/mui.css">
    <link rel="stylesheet" type="text/css" href="css/mui.picker.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script type="text/javascript" src="js/flexible.js"></script>
</head>

<body>
    <div class="page-top clearfix">
        <span>玩游天下_境外旅行险</span>
        <div class="logo-box">
            <img src="images/logo.png" class="logo">
        </div>
    </div>
    <div class="banner-box">
        <img src="images/banner.jpg">
    </div>
    <div class="session_1">
        <div class="item-box">
            <img src="images/icon_2.png" class="icon"><em>意外身故，烧伤及残疾保障</em>
            <span>500000<img src="images/icon_3.png"></span>
            <div class="info-box">
                在保险期间内,若被保险人在旅行时遭受意外伤害事故,并自事故发生之日起180日内因该事故导致身故的,保险公司按保险金额给付身故保险金;因该事故造成本保险合同所附《人身保险伤残评定标准》所列伤残项目的,保险公司按该表所列给付比例乘以保险金额给付伤残保险金。
            </div>
        </div>
        <div class="item-box">
            <img src="images/icon_2.png" class="icon"><em>突发急性病身故</em>
            <span>50000<img src="images/icon_3.png"></span>
            <div class="info-box">
                在保险期间内，若被保险人在旅行时遭受本条款列明的突发性疾病身故的（见《附加旅行突发性疾病身故保险条款》），保险人依据本附加条款约定，按保险单所载明的保险金额给付突发性疾病身故保险金。
            </div>
        </div>
        <div class="item-box">
            <img src="images/icon_2.png" class="icon"><em>意外医疗</em>
            <span>100000<img src="images/icon_3.png"></span>
            <div class="info-box">
                在保险期间内,若被保险人在旅行时遭受约定的意外事故或突发急性病,补偿被保险人已支出的、必需且合理的实际医药费用。（旅行医疗每次事故免赔额100元,给付比例80%）
            </div>
        </div>
        <div class="item-box">
            <img src="images/icon_2.png" class="icon"><em>每日住院津贴(最长赔偿30天)</em>
            <span>100/天<img src="images/icon_3.png"></span>
            <div class="info-box">
                在保险期间内，被保险人在境外旅行期间遭受意外伤害事故或突发急性病而住院，保险人将按照保险单所载的本附加险项下的每日给付金额乘以合理住院日数向被保险人支付住院津贴，最高不超过30天
            </div>
        </div>
        <div class="item-box">
            <img src="images/icon_2.png" class="icon"><em>医疗运送和送返</em>
            <span>100000<img src="images/icon_3.png"></span>
            <div class="info-box">
                在保险期间内,若被保险人在旅行时突发急性病或遭受意外事故,且当地医院条件不能保证被保险人得到充分的救治时，救援服务机构将以事发地能够提供的最合适的方式安排医疗设备、运输工具及随行医护人员，将被保险人转运至更适当的医院接受治疗，保险人将承担相应的运送费用，最高不超过保险金额
            </div>
        </div>
        <div class="other-box">
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>身故遗体送返（其中丧葬费用以RMB16000元为限）</em>
                <span>100000<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内，被保险人遭受意外伤害事故或突发急性病直接导致被保险人在境外身故的，根据被保险人亲属的要求，救援服务机构将被保险人之遗体送返被保险人亲属指定的地点或被保险人的合法有效证件所载的住所地，保险人承担相关费用，最高不超过保险金额（其中丧葬费用以RMB16000元为限）
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>家属慰问探访费用</em>
                <span>50000<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内，若被保险人在旅行时身故或者因遭受严重的身体伤害需住院治疗且住院连续十天以上,该被保险人的一名成年直系亲属因此前往被保险人所在地,保险公司给予费用补偿。(经济舱往返机票上限6000元,住宿费每日不超过1000，总费用补偿不超过保险金额)
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>旅行延误（RMB 300.00/5H）</em>
                <span>900<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内,若被保险人在境外旅行时因恶劣天气、自然灾害、机械故障、罢工、劫持或怠工,其他空运、航运工人的临时性抗议活动、恐怖主义行为、航空管制或航空公司超售的原因,导致原计划乘搭的公共交通工具延误,保险公司每5小时延误赔偿300元，最高不超过保险金额。
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>行李延误（RMB 500.00/8H）</em>
                <span>500<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内,若被保险人在旅行时的托运行李在其所乘的公共交通工具抵达预定目的地后,在保险单载明的时间内未送抵的,保险公司按照本附加险的约定,以保险单上所载本附加险项下相应的保险金额支付保险金。(每8小时延误赔偿500元，最高赔付金额500元）
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>旅行证件盗抢</em>
                <span>3000<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内，被保险人所拥有的旅行证件意外遭受条款载明事故导致损坏或遗失的，保险人按照约定赔付实际损失，最高不超过保险金额。
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>个人随身物品损失</em>
                <span>3000<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内，被保险人所拥有的行李物品意外遭受条款载明事故导致损坏或遗失的，保险人按照约定赔付实际损失，最高不超过保险金额。
                </div>
            </div>
            <div class="item-box">
                <img src="images/icon_2.png" class="icon"><em>个人责任</em>
                <span>50000<img src="images/icon_3.png"></span>
                <div class="info-box">
                    在保险期间内,若保险人在旅行时因意外事故导致他人身体或财物损失而须支付给第三方的赔偿金,保险公司负责赔偿,最高以保险金额为限。(第三者财产损失每次事故免赔额800元)
                </div>
            </div>
        </div>
        <div class="more">
            <div class="show"><span>查看更多</span><img src="images/icon_4.png"></div>
            <div class="hide"><span>收起</span><img src="images/icon_5.png"></div>
        </div>
    </div>
    <div class="session_2">
        <h3><span>填写被保人信息</span></h3>
        <div class="forms-box">
            <form>
                <div class="form-box">
                    <div class="input-box">
                        <label>姓名：</label>
                        <input type="" name="txt_1" placeholder="请输入姓名">
                    </div>
                    <div class="input-box">
                        <label>身份证号：</label>
                        <input type="number" name="txt_2" placeholder="请输入身份证号">
                    </div>
                    <div class="input-box">
                        <label>出发日期：</label>
                        <input type="" name="txt_3" class="time" readonly="readonly" placeholder="请输入出发日期">
                    </div>
                    <div class="input-box">
                        <label>目的地：</label>
                        <input type="" name="txt_4" class="site" readonly="readonly" placeholder="请输入目的地">
                    </div>
                    <div class="btns-box">
                        <span class="add-btn">添加被保人信息</span>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <button class="sub-btn" id="show-btn">
        立即提交投保信息
    </button>
    <script type="text/javascript" src="js/mui.min.js"></script>
    <script type="text/javascript" src="js/mui.picker.min.js"></script>
    <script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="js/jquery.validate.min.js"></script>
    <script type="text/javascript" src="layer_mobile/layer.js"></script>
    <script type="text/javascript" src="js/json2.js"></script>
    <script type="text/javascript">
    $('.session_1 .more').click(function() {
        if ($('.session_1').hasClass('active')) {
            $('.session_1').removeClass('active');
        } else {
            $('.session_1').addClass('active');
        }
    });
    $('.session_1 .item-box').click(function() {
        var title = $(this).find('em').text();
        if (title.length > 19) {
            title = title.substring(0, 19) + '...';
        }
        var info = $(this).find('.info-box').text();
        layer.open({
            title: [
                title
            ],
            anim: false,
            content: info,
            className: 'pop-box',
            btn: ['确定']
        });
    })

    var html_ = `<div class="form-box">
            <div class="input-box">
                <label>姓名：</label>
                <input type="" name="txt_1" placeholder="请输入姓名">
            </div>
            <div class="input-box">
                <label>身份证号：</label>
                <input type="number" name="txt_2" placeholder="请输入身份证号">
            </div>
            <div class="input-box">
                <label>出发日期：</label>
                <input type="" name="txt_3" readonly="readonly" class="time" placeholder="请输入出发日期">
            </div>
            <div class="input-box">
                <label>目的地：</label>
                <input type="" name="txt_4" class="site" readonly="readonly" placeholder="请输入目的地">
            </div>
            <div class="btns-box">
                <span class="del-btn">删除被保人信息</span>
                <span class="add-btn">添加被保人信息</span>
            </div>
        </div>`
    $('.session_2').on('click', '.add-btn', function() {
        $('.forms-box').append(html_);
        $(this).hide();
        $('#show-btn').removeAttr("disabled").removeClass('active').html('立即提交投保信息');     
    });
    $('.session_2').on('click', '.del-btn', function() {
        var _this = this;
        layer.open({
            content: '确实删除该增加的投保人信息！',
            btn: ['确定', '取消'],
            yes: function(index) {
                $(_this).parents('.form-box').remove();
                $('.form-box').last().find('.add-btn').show();
                layer.close(index);
            }
        });

    });

    // 时间
    (function(m) {
        m.init();
        $('.session_2').on('click', '.time', function() {
            var _self = this;
            picker_time = new m.DtPicker({ 
                "type": "date" 

            });
            picker_time.show(function(rs) {
                $(_self).val(rs.text);
                picker_time.dispose();
                picker_time = null;
            });
        });
        $('.session_2').on('click', '.site', function() {
            var _self = this;
            var picker = new m.PopPicker();
            picker.setData([{
                value: "泰国",
                text: "泰国"
            }])
            picker.show(function(items) {
                $(_self).val(items[0].value);
                picker.dispose();
                picker = null;
            });
        });

    })(mui);
     var _valid = true;
    $('#show-btn').click(function() {
        var all_list = [];
        var person = {};
        _valid = true;
        for (var i = $('.form-box').length - 1; i >= 0; i--) {
            if ($('.form-box').eq(i).find('input[name="txt_1"]').val() == '') {
                _valid = false;
                mui.toast('用户名不能为空', { duration: '600', type: 'div' });
                if (!_valid) {
                    return false;
                }
            } else {
                person.name = $('.form-box').eq(i).find('input[name="txt_1"]').val();
            }
            if ($('.form-box').eq(i).find('input[name="txt_2"]').val() == '') {
                _valid = false;
                mui.toast('身份证号不能为空', { duration: '600', type: 'div' });
                if (!_valid) {
                    return false;
                }
            } else {
                person.idCard = $('.form-box').eq(i).find('input[name="txt_2"]').val();
            }
            if ($('.form-box').eq(i).find('input[name="txt_3"]').val() == '') {
                _valid = false;
                mui.toast('出发时间不能为空', { duration: '600', type: 'div' });
                if (!_valid) {
                    return false;
                }
            } else {
                person.leaveDate = $('.form-box').eq(i).find('input[name="txt_3"]').val();
            }
            if ($('.form-box').eq(i).find('input[name="txt_4"]').val() == '') {
                _valid = false;
                mui.toast('目的地不能为空', { duration: '600', type: 'div' });
                if (!_valid) {
                    return false;
                }
            } else {
                person.destination = $('.form-box').eq(i).find('input[name="txt_4"]').val();
            }
            all_list.push(person);
        }
        //这个到提交的ajax就好了
        submit({'data':all_list});
    });


    function submit(all_list){
        $.ajax({     
                url:"http://120.79.63.136:8088/travel/app/trParticipants/addTrParticipants",
                type:"post",
                contentType:'application/json',
                dataType : "json",
                data:JSON.stringify(all_list),
                success: function(msg){
                    console.log(msg);
                    if(msg.resultCode==0){
                     mui.toast('提交成功！', { duration: '800', type: 'div' });
                    $('#show-btn').attr("disabled","disabled").addClass('active').html('参保信息已提交成功');     

                    }else{
                        mui.toast('服务器忙...', { duration: '600', type: 'div' });
                    }
                },
                error:function(msg){
                    console.log(msg);
                    mui.toast('服务器忙...', { duration: '600', type: 'div' });
                }
        })
    }
    </script>
</body>

</html>