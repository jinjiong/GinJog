<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<title>喵果</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="../css/iconfont.css">
	<link rel="stylesheet" type="text/css" href="../css/style.css">
	<!-- 适配手机屏幕的大小 -->
	<script type="text/javascript" src='../js/flexible.js'></script>
</head>
<body class="nhome pm100">
    <div class="appraise-wrap">
        <div class="appraise-top">
            <div class="img-box">
                <img src="../upload/po16.jpg">
            </div>
            <div class="text-box">
                <p class="name">越南红心火龙果</p>
                <p>总价：12.9  数量：1</p>
                <p>购买时间：3小时前</p>
            </div>
            <div class="grade">
                <span class="grade-txt"><em>10</em>分</span>
                <p><span class="txt">总体</span><span class="all-star"><i class="iconfont icon-favorfill"></i><i class="iconfont icon-favorfill"></i><i class="iconfont icon-favorfill"></i><i class="iconfont icon-favorfill"></i><i class="iconfont icon-favorfill"></i></span></p>
            </div>
            <div class="grade-text">
                <textarea class="textarea" placeholder="感觉喵果怎么样呢？分享一下你的消费感受吧！您提出的每个建议，我们都会努力改进"></textarea>
            </div>
            <div class="grade-voice">
               <span class="title">语言</span>
               <div class="clearfix line">
                   <div class="voico-nub voice-box">
                       <span class="play-btn"></span>
                       <span class="nub">25</span>
                   </div>
                   <div class="pin-box">
                        <i class="iconfont icon-cnhuatong"></i>
                        <p>按住说话</p>
                   </div>
               </div>
            </div>
            <div class="upload-box clearfix">
                <span class="title">上传图片</span>
                <div class="imgs">
                </div>
                <div class="file-box">
                  <input class="camera-box" type="file" id="file" accept="image/*" capture=camera">
                    <i class="iconfont icon-ai-camera"></i>
                </div>
            </div>
        </div>
        <div class="appraise-btn">提交评价</div>
    </div>
    <div class="fa-box">
      <img src="../static/catfruit/img/fa.png">
      <p>手指上滑，取消发送</p>
    </div>
</body>
<script type="text/javascript" src="../js/jquery-1.12.2.min.js"></script>
<script type="text/javascript" src='../js/layer.js'></script>
<script>

$('.textarea').change(function(){
    if($(this).val() == ''){
        $('.appraise-btn').removeClass('active')
    }else{
         $('.appraise-btn').addClass('active');
    }
});
$('#file').on('change',function(){
    if($('.img-box').length<5){
            console.log($('.img-box').length);
            var fileObj=document.getElementById("file");
            var src = window.URL.createObjectURL(fileObj.files[0]);
            var html = '<div class="img-box">'+
                           '<img src="'+src+'">'+
                            '<div class="iconfont-close"></div>'+
                        '</div>';
            $('.imgs').prepend(html);
        }else{
            layer.msg('最多上传四张图片');
        }
})
$('.imgs').on('click','.iconfont-close',function(){
    $(this).parent('.img-box').remove();

});
$('.voice-box').click(function(){
    if ($(this).hasClass('active')) {

        $(this).removeClass('active');
    }else{
        $('.voice-box').removeClass('active');
        $(this).addClass('active');
    }
})
$('.all-star .iconfont').click(function(){
    if($(this).hasClass('fcf47596')){
       $(this).removeClass('fcf47596').nextAll().removeClass('fcf47596');
        var nub = $('.all-star .fcf47596').length;
         $('.grade-txt em').text(2*nub);

    }else{
        $(this).addClass('fcf47596').prevAll().addClass('fcf47596');
         var nub = $('.all-star .fcf47596').length;
         $('.grade-txt em').text(2*nub);
    }
    if ($('.grade-txt em').text()!=0) {
         $('.appraise-btn').addClass('active');
     }else{
        $('.appraise-btn').removeClass('active');
     }
});

/*长按事件*/
$(function(){
  $(".pin-box").on({
    touchstart: function(e){
        timeOutEvent = setTimeout("longPress()",500);
        e.preventDefault();
    },
    touchmove: function(){
        clearTimeout(timeOutEvent); 
        timeOutEvent = 0; 
    },
    touchend: function(){
        clearTimeout(timeOutEvent);
        $('.fa-box').hide();
        if(timeOutEvent!=0){ 
            // alert("你这是点击，不是长按"); 
        } 
        return false; 
    }
  })
});

function longPress(){ 
    timeOutEvent = 0; 
    // alert("长按事件触发发"); 
    $('.fa-box').show();
} 
</script>
</html>